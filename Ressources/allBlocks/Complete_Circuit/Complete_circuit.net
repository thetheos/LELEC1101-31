* C:\users\thetheos\My Documents\Université\BAC2\Q4.P_Elec\Ressources\allBlocks\Complete_Circuit\Complete_circuit.asc
XU1 VF1 0 V++ V-- VS1 TL084
XU2 N010 N008 V++ V-- VDiff TL084
R1 N008 VS2 10k
R2 N010 VS1 10k
R3 VDiff N008 20k
R4 N010 0 20k
XU4 N016 N017 VDP2 opamp Aol=100K GBW=100Meg
C2 N017 0 {C}
R9 N017 VF2 {1/{2*pi*fo*C}}
R10 N016 VF2 10k
R11 VDP2 N016 10k
R5 VF1 N001 100k
C1 VF1 N001 0.53n
C3 N001 N007 15.9µ
R6 N007 IN1 1k
XU3 0 N001 V++ V-- VF1 TL084
V8 V++ 0 15
V9 V-- 0 -15
B1 P001 0 V=(white(2e6*time)/10)
V12 NC_01 P001 SINE(0 1 3000 0 0 -90)
V14 NC_02 P002 SINE(0 1 3000)
B2 P002 0 V=(white(2e6*time)/10)
R8 VF2 N012 100k
C4 VF2 N012 0.53n
C5 N012 N013 15.9µ
R12 N013 IN2 1k
XU5 0 N012 V++ V-- VF2 TL084
XU6 VDP2 0 V++ V-- VS2 TL084
R7 N011 Vdir+ 20k
C6 Vdir- Vdir+ 80n
D1 Vdir- VDiff 1N4148
D2 VDiff N011 1N4148
D3 Vdir- 0 1N4148
D4 0 N011 1N4148
XU7 N003 N002 V++ V-- Vdirdiff TL084
R16 Vdirdiff N002 20k
R17 N002 Vdir+ 10k
R14 N003 Vdir- 10k
R15 N003 0 20k
XU8 0 N004 V++ V-- OUT TL084
R18 N004 Vdirdiff 10k
R19 N004 N009 10k
R20 0 N009 100
R21 N009 V++ 68.5
R22 OUT N004 10k
J1 N006 N005 0 NJF
R13 V++ N006 14k
V1 N005 0 SINE(0 0.1 3000 0 0 -60)
C7 N006 IN1 2.2µ
J2 N015 N014 0 NJF
R24 V++ N015 14k
V2 N014 0 SINE(0 0.1 3000 0 0 0)
C8 N015 IN2 2.2µ
.model D D
.lib C:\users\thetheos\My Documents\LTspiceXVII\lib\cmp\standard.dio
.model NJF NJF
.model PJF PJF
.lib C:\users\thetheos\My Documents\LTspiceXVII\lib\cmp\standard.jft
* Saturation comparator
* Differential Comparator
* pi half Phase shifter
.param C=3.3n fo=3k
.inc opamp.sub
.include ../TL084.lib
.tran 0 1 0 1m
* Filter
* Mic. input
* Opamp voltage
* Rectifier and low pass filter
* Differential amplifier
* DC offset (sum op-amp)
* Direction and angle
* Description:\nINPUT: Two square signals dephased of pi/2.\nOUTPUT: A DC voltage between [V--/2;V++/2] proportional to sin(phi) \n                (Phi is the phase difference between the two input signals)\n \nDetailed explanation:\nThe first differential amplifier substract the two input signals.\nThis output is rectified and goes straight to a low-pass filter to get the average (dc component)\nTo center the voltage around 0V (if DC < V++/2 then the voltage is negative\nThe differential voltage after the low pass filter go through a differential opamp to set voltage refference back to ground\nWe use a summing opamp. In wich we sum a constant dc offset via the voltage divider
* Rectifier
* Low pass filter
.include ../LM311.301
.backanno
.end
