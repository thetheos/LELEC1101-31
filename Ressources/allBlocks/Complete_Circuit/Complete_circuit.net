* C:\Users\guill\Programmes\LELEC1101-31\Ressources\allBlocks\Complete_Circuit\Complete_circuit.asc
XU1 VF1 0 V++ V-- VS1 TL084
XU2 N017 N013 V++ V-- VDiff TL084
R1 N013 VS2 10k
R2 N017 VS1 10k
R3 VDiff N013 20k
R4 N017 0 20k
XU4 N023 N024 VDP2 opamp Aol=100K GBW=100Meg
C2 N024 0 {C}
R9 N024 VF2 {1/{2*pi*fo*C}}
R10 N023 VF2 10k
R11 VDP2 N023 10k
R5 VF1 N001 100k
C1 VF1 N001 0.53n
C3 N001 N012 15.9µ
R6 N012 IN1 1k
XU3 0 N001 V++ V-- VF1 TL084
V8 V++ 0 15
V9 V-- 0 -15
B1 P001 0 V=(white(2e6*time)/10)
V12 NC_01 P001 SINE(0 1 3000 0 0 -90)
V14 NC_02 P002 SINE(0 1 3000)
B2 P002 0 V=(white(2e6*time)/10)
R8 VF2 N019 100k
C4 VF2 N019 0.53n
C5 N019 N022 15.9µ
R12 N022 IN2 1k
XU5 0 N019 V++ V-- VF2 TL084
XU6 VDP2 0 V++ V-- VS2 TL084
R7 N018 Vdir+ 20k
C6 Vdir- Vdir+ 80n
D1 Vdir- VDiff 1N4148
D2 VDiff N018 1N4148
D3 Vdir- 0 1N4148
D4 0 N018 1N4148
XU7 N007 N002 V++ V-- Vdirdiff TL084
R16 Vdirdiff N002 20k
R17 N002 Vdir+ 10k
R14 N007 Vdir- 10k
R15 N007 0 20k
XU8 0 N008 V++ V-- OUT TL084
R18 N008 Vdirdiff 10k
R19 N008 N016 10k
R20 0 N016 100
R21 N016 V++ 68.5
R22 OUT N008 10k
J1 N009 N006 0 NJF
R13 V++ N009 14k
V1 N006 0 SINE(0 0.001 3000 0 0 -60)
C7 N009 IN1 2.2µ
J2 N021 N020 0 NJF
R24 V++ N021 14k
V2 N020 0 SINE(0 0.001 3000 0 0 0)
C8 N021 IN2 2.2µ
R23 N005 OUT 10k
R25 N005 N014 64.64k
R26 N005 N011 4k
R27 N003 OUT 4K
D5 N014 OUT D
D6 N004 N003 D
D7 N005 N004 D
D8 OUT N014 D
D9 N010 N011 D
D10 OUT N010 D
XU9 0 N005 Vcc Vee N015 TL084
R28 N015 N005 35k
.model D D
.lib C:\Users\guill\Documents\LTspiceXVII\lib\cmp\standard.dio
.model NJF NJF
.model PJF PJF
.lib C:\Users\guill\Documents\LTspiceXVII\lib\cmp\standard.jft
* Saturation comparator
* Differential Comparator
* pi half Phase shifter
.param C=3.3n fo=3k
.inc opamp.sub
.include ../TL084.lib
.tran 0 1 0 1m
* Filter
* Mic. input
* Opamp voltage
* Rectifier and low pass filter
* Differential amplifier
* DC offset (sum op-amp)
* Direction and angle
* Description:\nINPUT: Two square signals dephased of pi/2.\nOUTPUT: A DC voltage between [V--/2;V++/2] proportional to sin(phi) \n                (Phi is the phase difference between the two input signals)\n \nDetailed explanation:\nThe first differential amplifier substract the two input signals.\nThis output is rectified and goes straight to a low-pass filter to get the average (dc component)\nTo center the voltage around 0V (if DC < V++/2 then the voltage is negative\nThe differential voltage after the low pass filter go through a differential opamp to set voltage refference back to ground\nWe use a summing opamp. In wich we sum a constant dc offset via the voltage divider
* Rectifier
* Low pass filter
.include ../LM311.301
* Micros
* 1k 6.4k 220
.backanno
.end
